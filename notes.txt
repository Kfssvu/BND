<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App with GA Consent</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh; /* Ensure body takes full viewport height */
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Push content up, banner down */
            background-color: #f0f4f8; /* Light background for the page */
        }
        main {
            flex-grow: 1; /* Allow main content to take available space */
            padding: 2rem;
            text-align: center;
        }
        /* Custom styles for the banner to ensure it's always at the bottom */
        #ga-consent-banner {
            position: fixed; /* Keep it fixed at the bottom */
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 1000; /* Ensure it's above other content */
        }
    </style>
</head>
<body>

    <main class="container mx-auto p-4 flex flex-col items-center justify-center h-full">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">Welcome to Our Application!</h1>
        <p class="text-lg text-gray-600">This is a sample page demonstrating a Google Analytics consent notification.</p>
        <p class="text-md text-gray-500 mt-2">Scroll down to see the consent banner.</p>
    </main>

    <!-- Google Analytics Consent Banner -->
    <div id="ga-consent-banner" class="bg-gray-900 text-white p-4 shadow-lg rounded-t-lg md:flex md:items-center md:justify-between transition-transform duration-300 ease-in-out transform translate-y-full">
        <div class="flex-1 mb-4 md:mb-0 md:mr-4">
            <p class="text-sm">
                We use Google Analytics to understand how you use our application and improve your experience. This helps us make the app better for you.
                By clicking "Accept", you consent to the use of these cookies. You can learn more in our <a href="#" class="text-blue-400 hover:underline">Privacy Policy</a>.
            </p>
        </div>
        <div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2">
            <button id="accept-ga" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                Accept
            </button>
            <button id="decline-ga" class="bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                Decline
            </button>
        </div>
    </div>

    <script>
        const consentBanner = document.getElementById('ga-consent-banner');
        const acceptButton = document.getElementById('accept-ga');
        const declineButton = document.getElementById('decline-ga');
        const gaConsentKey = 'ga_consent_status'; // Key for localStorage

        // Function to load Google Analytics script
        function loadGoogleAnalytics() {
            // Replace 'YOUR_GA_MEASUREMENT_ID' with your actual GA4 Measurement ID (e.g., 'G-XXXXXXXXXX')
            const gaMeasurementId = 'YOUR_GA_MEASUREMENT_ID'; 

            if (gaMeasurementId === 'YOUR_GA_MEASUREMENT_ID') {
                console.warn('Google Analytics Measurement ID is not set. Please replace "YOUR_GA_MEASUREMENT_ID" with your actual GA4 ID.');
                return;
            }

            const script = document.createElement('script');
            script.src = `https://www.googletagmanager.com/gtag/js?id=${gaMeasurementId}`;
            script.async = true;
            document.head.appendChild(script);

            script.onload = () => {
                window.dataLayer = window.dataLayer || [];
                function gtag(){dataLayer.push(arguments);}
                gtag('js', new Date());
                gtag('config', gaMeasurementId);
                console.log('Google Analytics loaded and configured.');
            };
        }

        // Function to show the banner
        function showBanner() {
            consentBanner.classList.remove('translate-y-full');
        }

        // Function to hide the banner
        function hideBanner() {
            consentBanner.classList.add('translate-y-full');
        }

        // Check user's consent status on page load
        document.addEventListener('DOMContentLoaded', () => {
            const consentStatus = localStorage.getItem(gaConsentKey);

            if (consentStatus === 'accepted') {
                loadGoogleAnalytics();
                hideBanner(); // Hide banner if already accepted
            } else if (consentStatus === 'declined') {
                hideBanner(); // Hide banner if already declined
            } else {
                // If no consent status, show the banner after a short delay
                // This delay ensures the page content loads first
                setTimeout(showBanner, 500); 
            }
        });

        // Event listener for Accept button
        acceptButton.addEventListener('click', () => {
            localStorage.setItem(gaConsentKey, 'accepted');
            loadGoogleAnalytics();
            hideBanner();
            console.log('Google Analytics consent accepted.');
        });

        // Event listener for Decline button
        declineButton.addEventListener('click', () => {
            localStorage.setItem(gaConsentKey, 'declined');
            hideBanner();
            console.log('Google Analytics consent declined.');
            // If you want to ensure GA is not loaded even if it was pre-loaded
            // (e.g., if you had a default load before consent), you might
            // need to clear GA cookies or prevent further tracking here.
            // For this example, we only load GA *after* consent.
        });
    </script>

</body>
</html>
